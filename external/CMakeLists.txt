cmake_minimum_required(VERSION 3.14.5)


include(cmakescripts/imgui.cmake)
include(cmakescripts/glfw.cmake)
if(${xhfr_LuaJit})
    include(cmakescripts/luajit.cmake)
else()
    add_subdirectory(lua)
    ##neded for emscripten
    include_directories(SYSTEM lua/src)
endif()

add_subdirectory(stb)
add_subdirectory(sol2)
if(NOT ${xhfr_PhysFs_external})
    add_subdirectory(physfs)
endif()
if(${xhfr_FreeType})
    include(cmakescripts/freetype.cmake)
endif()

if(${xhfr_Backend} STREQUAL "sdl")
    add_subdirectory(glad)
    add_subdirectory(sdl)
elseif(${xhfr_Backend} STREQUAL "sdl-ems")
    set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -s ERROR_ON_UNDEFINED_SYMBOLS=0 -s USE_SDL=2 -s USE_WEBGL2=1 -s WASM=1 -s FULL_ES3=1 -s ALLOW_MEMORY_GROWTH=1 -s BINARYEN_TRAP_MODE=clamp")
    set(CMAKE_C_FLAGS "${CMAKE_C_FLAGS} -s ERROR_ON_UNDEFINED_SYMBOLS=0 -s USE_SDL=2 -s USE_WEBGL2=1 -s WASM=1 -s FULL_ES3=1 -s ALLOW_MEMORY_GROWTH=1 -s BINARYEN_TRAP_MODE=clamp")
else()
    add_subdirectory(glad)
    add_subdirectory(glfw)
endif()
